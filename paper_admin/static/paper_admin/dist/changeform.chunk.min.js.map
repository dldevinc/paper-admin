{"version":3,"sources":["webpack:///./paper_admin/static/paper_admin/src/js/components/inlines/inlines.js","webpack:///./paper_admin/static/paper_admin/src/js/components/autosize.js","webpack:///./paper_admin/static/paper_admin/src/js/components/tabs.js","webpack:///./paper_admin/static/paper_admin/src/js/widgets/autocomplete.js","webpack:///./paper_admin/static/paper_admin/src/js/widgets/clearable_file.js","webpack:///./paper_admin/static/paper_admin/src/js/widgets/email.js","webpack:///./paper_admin/static/paper_admin/src/js/widgets/multiselect.js","webpack:///./paper_admin/static/paper_admin/src/js/widgets/url.js","webpack:///./paper_admin/static/paper_admin/src/js/components/inlines/SortButtons.js","webpack:///./paper_admin/static/paper_admin/src/js/components/inlines/sortable.js","webpack:///./paper_admin/static/paper_admin/src/js/widgets/datetime.js","webpack:///./paper_admin/static/paper_admin/src/js/changeform.js","webpack:///./paper_admin/static/paper_admin/src/js/components/RelatedObjectLookups.js","webpack:///./paper_admin/static/paper_admin/src/js/components/hook_unload.js","webpack:///./paper_admin/static/paper_admin/src/js/widgets/password.js"],"names":["ManagementForm","element","this","Formset","root","options","opts","Object","assign","prefix","addButtonSelector","deleteButtonSelector","formCssClass","emptyCssClass","animationSpeed","onAdded","onRemove","_inline_formset","mgmt","addButton","querySelector","Error","hidden","totalForms","maxForms","addEventListener","event","preventDefault","addRow","bind","that","target","closest","row","deleteRow","updateFormIndex","index","regex","RegExp","replacement","querySelectorAll","forEach","htmlFor","replace","id","name","setAttribute","updateInlineLabel","label","innerHTML","gsap","registerPlugin","ScrollToPlugin","prototype","__property","selector","value","input","parseInt","toString","isNaN","getRows","templateElement","cloneNode","pageYOffset","window","document","documentElement","scrollTop","classList","remove","parentNode","insertBefore","scrollTo","top","tagName","from","duration","height","clearProps","deleteButton","call","dispatchEvent","CustomEvent","detail","emitters","dom","trigger","inlines","$","rows","Array","row_index","indexOf","i","length","to","onComplete","removeChild","whenDomReady","body","inlineGroup","dataset","inlineType","inlinePrefix","initAutosize","matches","autosize","on","tab_selector","getAttribute","tab_pane","update","paperAdmin","errorContainers","firstErrorContainer","find","errorContainer","errorTop","getBoundingClientRect","clientHeight","setTimeout","y","Math","floor","offsetY","hash","location","substr","current_tab","tab","tab_name","history","replaceState","form","getElementById","action","URL","initWidget","select2","initWidgets","ajax","data","params","term","page","fileName","split","pop","buttonName","nextElementSibling","textContent","initialText","add","widget","link_tag","trim","href","removeAttribute","multiSelect","link","SortButtons","speed","items","moveUpBtn","moveDownBtn","disabledClass","scrollWindow","scrollMargin","bottom","ignore","onChange","_onClick","updateBounds","moveUpButton","contains","item","stopPropagation","moveUp","moveDownButton","moveDown","_findNextItem","nextItem","_findPreviousItem","prevItem","previousElementSibling","_swap","elem1","elem2","reversed","rect1","rect2","initialCSSText1","style","cssText","initialCSSText2","disableItemButtons","after","spaceY","transform","tl","TimelineLite","newYOffset","topBound","bottomBound","innerHeight","needScrollWindow","max","upBtn","downBtn","firstItem","firstItemBtn","lastItem","lastItemBtn","sortButtonsObj","currentOrder","inlineForm","formUtils","containsChangedField","fillInlineOrder","inlineFormset","replaceFormIndex","flatpickr","date_selector","date_options","altInput","altFormat","dateFormat","time_selector","time_options","allowInput","enableTime","noCalendar","time_24hr","fake_event","KeyboardEvent","bubbles","cancelable","keyCode","deltaY","passive","button","_flatpickr","open","hookUnload","django_prepopulated_fields","id_to_windowname","text","windowname_to_id","showAdminPopup","triggeringLink","name_regexp","add_popup","browser_left","screenX","screenLeft","browser_top","screenY","screenTop","browser_width","outerWidth","clientWidth","browser_height","outerHeight","top_position","round","left_position","focus","showRelatedObjectLookupPopup","showRelatedObjectPopup","updateRelatedObjectLinks","$this","siblings","val","each","elm","attr","removeAttr","dismissAddRelatedObjectPopup","win","newId","newRepr","elem","elemName","nodeName","toUpperCase","Option","className","close","dismissRelatedLookupPopup","chosenId","dismissChangeRelatedObjectPopup","objId","dismissDeleteRelatedObjectPopup","showAddAnotherPopup","dismissAddAnotherPopup","ready","opener","e","Event","isDefaultPrevented","checked","jQuery","submit","formHasChanged","message","gettext","userActionHandler","removeEventListener","changeHandler","evt","returnValue","toggler","field","icon","classes","types","type"],"mappings":"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","file":"changeform.chunk.min.js","sourcesContent":["/**\n * Класс для работы с инлайн-формами.\n * @namespace Formset\n */\n\nimport whenDomReady from \"when-dom-ready\";\nimport emitters from \"../emitters\";\nimport {gsap} from \"gsap\";\nimport {ScrollToPlugin} from \"gsap/ScrollToPlugin\";\ngsap.registerPlugin(ScrollToPlugin);\n\n\n/**\n * Конструктор объектов ManagementForm\n * @param {Element} element\n * @constructor\n */\nfunction ManagementForm(element) {\n    this.element = element;\n}\n\nManagementForm.prototype.__property = function(selector) {\n    return function(value) {\n        const input = this.element.querySelector(selector);\n        if (typeof value === 'undefined') {\n            return parseInt(input.value.toString())\n        } else {\n            value = parseInt(value);\n            if (!isNaN(value)) {\n                input.value = value;\n            }\n        }\n    }\n};\n\nManagementForm.prototype.totalForms = ManagementForm.prototype.__property('input[name$=\"-TOTAL_FORMS\"]');\nManagementForm.prototype.maxForms = ManagementForm.prototype.__property('input[name$=\"-MAX_NUM_FORMS\"]');\n\n\n/**\n * Конструктор объектов Formset\n *\n * @param {Element|Node} root\n * @param {Object} [options]\n * @constructor\n */\nfunction Formset(root, options) {\n    this.opts = Object.assign({\n        prefix: 'form',\n        addButtonSelector: '.add-row',\n        deleteButtonSelector: '.delete-row',\n        formCssClass: 'inline-related',\n        emptyCssClass: 'empty-form',\n        animationSpeed: 300,\n        onAdded: null,\n        onRemove: null\n    }, options);\n\n    this.root = root;\n    this.root._inline_formset = this;\n    this.mgmt = new ManagementForm(root);\n\n    this.addButton = this.root.querySelector(this.opts.addButtonSelector);\n    if (!this.addButton) {\n        throw new Error('addButton not found');\n    }\n    this.addButton.hidden = this.mgmt.totalForms() >= this.mgmt.maxForms();\n    this.addButton.querySelector('a, button').addEventListener('click', function(event) {\n        event.preventDefault();\n        this.addRow();\n    }.bind(this));\n\n    const that = this;\n    this.root.addEventListener('click', function(event) {\n        const target = event.target;\n        const button = target.closest(that.opts.deleteButtonSelector);\n        if (button) {\n            event.preventDefault();\n            const row = target.closest('.' + that.opts.formCssClass);\n            that.deleteRow(row);\n        }\n    });\n}\n\n\n/**\n * Получение всех форм.\n * @returns {NodeListOf<Element>}\n */\nFormset.prototype.getRows = function() {\n    return this.root.querySelectorAll('.' + this.opts.formCssClass);\n};\n\n\n/**\n * Добавление новой формы.\n * @returns {?Node}\n */\nFormset.prototype.addRow = function() {\n    let totalForms = this.mgmt.totalForms();\n    const maxForms = this.mgmt.maxForms();\n    if (totalForms >= maxForms) {\n        return null\n    }\n\n    const templateElement = this.root.querySelector('.' + this.opts.emptyCssClass);\n    if (!templateElement) {\n        throw new Error('template form not found');\n    }\n\n    const row = templateElement.cloneNode(true);\n    const pageYOffset = window.pageYOffset || document.documentElement.scrollTop;\n    row.classList.remove(this.opts.emptyCssClass);\n    templateElement.parentNode.insertBefore(row, templateElement);\n\n    window.scrollTo({\n        top: pageYOffset\n    });\n\n    if (row.tagName !== 'TR') {\n        gsap.from(row, {\n            duration: this.opts.animationSpeed / 1000,\n            height: 0,\n            clearProps: 'all',\n        });\n    }\n\n    this.mgmt.totalForms(++totalForms);\n\n    // addButton\n    this.addButton.hidden = totalForms >= maxForms;\n\n    // deleteButton\n    const deleteButton = row.querySelector(this.opts.deleteButtonSelector);\n    if (deleteButton) {\n        deleteButton.hidden = false;\n    }\n\n    // event\n    if (this.opts.onAdded) {\n        this.opts.onAdded.call(this, row, this.opts.prefix, totalForms);\n    }\n    this.root.dispatchEvent(new CustomEvent('row-added', {\n        detail: [row, this.opts.prefix]\n    }));\n    emitters.dom.trigger('mutate', [row]);\n    emitters.inlines.trigger('added', [row, this.opts.prefix]);\n\n    // Django compatible\n    $(document).trigger('formset:added', [$(row), this.opts.prefix]);\n\n    return row;\n};\n\n\n/**\n * Удаление формы.\n * @param {Element|Node} row\n */\nFormset.prototype.deleteRow = function(row) {\n    let totalForms = this.mgmt.totalForms();\n\n    const rows = Array.from(this.getRows());\n    const row_index = rows.indexOf(row);\n    if (this.opts.onRemove) {\n        for (let i=row_index+1; i<rows.length; i++) {\n            this.opts.onRemove.call(this, rows[i], this.opts.prefix, i);\n        }\n    }\n\n    // event\n    emitters.dom.trigger('release', [row]);\n    emitters.inlines.trigger('remove', [row, this.opts.prefix]);\n\n    if (row.tagName !== 'TR') {\n        gsap.to(row, {\n            duration: this.opts.animationSpeed / 1000,\n            height: 0,\n            onComplete: function() {\n                row.parentNode.removeChild(row);\n            }\n        });\n    }\n\n    // event\n    emitters.inlines.trigger('removed', [row, this.opts.prefix]);\n    this.root.dispatchEvent(new CustomEvent('row-removed', {\n        detail: [row, this.opts.prefix]\n    }));\n\n    // Django compatible\n    $(document).trigger('formset:removed', [$(row), this.opts.prefix]);\n\n    this.mgmt.totalForms(--totalForms);\n\n    // addButton\n    this.addButton.hidden = totalForms >= this.mgmt.maxForms();\n};\n\n\n/**\n * Установка порядкового номера всем элементам формы.\n * @param {Element|Node} row\n * @param {String} prefix\n * @param {Number} index\n */\nfunction updateFormIndex(row, prefix, index) {\n    const regex = new RegExp(\"(\" + prefix + \"-(\\\\d+|__prefix__))\");\n    const replacement = prefix + \"-\" + (index - 1);\n    row.querySelectorAll('*').forEach(function(element) {\n        if (element.htmlFor) {\n            element.htmlFor = element.htmlFor.replace(regex, replacement);\n        }\n        if (element.id) {\n            element.id = element.id.replace(regex, replacement);\n        }\n        if (element.name) {\n            element.name = element.name.replace(regex, replacement);\n        }\n    });\n    row.setAttribute('id', prefix + '-' + (index - 1));\n}\n\n\n/**\n * Обновление заголовка формы.\n * @param {Element|Node} row\n * @param {Number} index\n */\nfunction updateInlineLabel(row, index) {\n    const label = row.querySelector('.inline-label');\n    if (label) {\n        label.innerHTML = label.innerHTML.replace(/(#\\d+)/g, \"#\" + index);\n    }\n}\n\n\nfunction initInlineGroups(root = document.body) {\n    root.querySelectorAll('.inline-group').forEach(function(inlineGroup) {\n        switch(inlineGroup.dataset.inlineType) {\n            case \"stacked\":\n                new Formset(inlineGroup, {\n                    prefix: inlineGroup.dataset.inlinePrefix,\n                    onAdded: function(row, prefix, index) {\n                        updateFormIndex(row, prefix, index);\n                        updateInlineLabel(row, index);\n                    },\n                    onRemove: function(row, prefix, index) {\n                        updateFormIndex(row, prefix, index);\n                        updateInlineLabel(row, index);\n                    }\n                });\n                break;\n            case \"tabular\":\n                new Formset(inlineGroup, {\n                    prefix: inlineGroup.dataset.inlinePrefix,\n                    onAdded: function(row, prefix, index) {\n                        updateFormIndex(row, prefix, index);\n                    },\n                    onRemove: function(row, prefix, index) {\n                        updateFormIndex(row, prefix, index);\n                    }\n                });\n                break;\n        }\n    });\n}\n\n\nwhenDomReady(initInlineGroups);\n","import autosize from \"autosize\";\nimport whenDomReady from \"when-dom-ready\";\nimport emitters from \"./emitters\";\n\n\nfunction initAutosize(root = document.body) {\n    let selector = 'textarea[autosize]';\n    root.matches(selector) && autosize(root);\n    autosize(root.querySelectorAll(selector));\n}\n\n\nwhenDomReady(function() {\n    initAutosize();\n\n    // FIX bootstrap tabs\n    $(document).on('shown.bs.tab', function(event) {\n        const tab_selector = event.target.getAttribute('href');\n        const tab_pane = tab_selector && document.querySelector(tab_selector);\n        if (tab_pane) {\n            autosize.update(tab_pane.querySelectorAll('textarea[autosize]'));\n        }\n    });\n});\n\nemitters.dom.on('mutate', initAutosize);\n\n// share plugin\nwindow.paperAdmin = window.paperAdmin || {};\nObject.assign(window.paperAdmin, {\n    autosize,\n});\n","import {gsap} from \"gsap\";\nimport {ScrollToPlugin} from \"gsap/ScrollToPlugin\";\nimport whenDomReady from \"when-dom-ready\";\ngsap.registerPlugin(ScrollToPlugin);\n\nconst ERROR_MIN_VISIBILITY = 50;\n\n\nwhenDomReady(function() {\n    const errorContainers = document.querySelectorAll('.invalid, .formset-errors, .formset-form-errors');\n    const firstErrorContainer = Array.from(errorContainers).find(function(errorContainer) {\n        return errorContainer.innerHTML !== '';\n    });\n\n    if (firstErrorContainer) {\n        // скролл к ошибке\n        const errorRect = firstErrorContainer.getBoundingClientRect();\n        const errorTop = errorRect.top;\n        const isVisible = (errorTop > ERROR_MIN_VISIBILITY) && (errorTop < document.documentElement.clientHeight - ERROR_MIN_VISIBILITY);\n        if (!isVisible) {\n            setTimeout(function() {\n                gsap.to(window, {\n                    duration: 0.5,\n                    scrollTo: {\n                        y: errorTop - Math.floor(document.documentElement.clientHeight / 2),\n                        offsetY: -25\n                    }\n                });\n            });\n        }\n    } else {\n        const hash = location.hash.substr(1).replace(/-panel$/i, '-tab');\n        const current_tab = hash && document.querySelector(`#${hash}`);\n        if (current_tab) {\n            $(current_tab).tab('show');\n        }\n    }\n});\n\n\n$(document).on('shown.bs.tab', function(event) {\n    const tab_name = event.target.getAttribute('aria-controls');\n    if (tab_name) {\n        history.replaceState(null, '', `#${tab_name}`);\n\n        const form = document.getElementById('changeform');\n        if (form) {\n            const action = new URL(form.action);\n            action.hash = tab_name;\n            form.action = action.toString();\n        }\n    }\n});\n","import \"select2\";\nimport whenDomReady from \"when-dom-ready\";\nimport emitters from \"../components/emitters\";\n\n// CSS\nimport \"select2/dist/css/select2.min.css\";\nimport \"../../css/widgets/autocomplete.css\";\n\n\nfunction initWidget(options, element) {\n    if (!element.closest('.empty-form')) {\n        $(element).select2(options);\n    }\n}\n\n\n/**\n * Инициализация Autocomplete виджетов\n * @param {Element} [root]\n */\nfunction initWidgets(root = document.body) {\n    let selector = '.admin-autocomplete';\n    let options = {\n        ajax: {\n            data: function(params) {\n                return {\n                    term: params.term,\n                    page: params.page\n                };\n            }\n        }\n    };\n    root.matches(selector) && initWidget(options, root);\n    root.querySelectorAll(selector).forEach(initWidget.bind(null, options));\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n","/**\n * Вставка имени файла в название кнопки\n */\ndocument.addEventListener('change', function(event) {\n    const target = event.target;\n    if ((target.tagName === 'INPUT') && target.closest('.vClearableFileField')) {\n        let fileName = target.value.split('\\\\').pop();\n        let buttonName = target.nextElementSibling.querySelector('span');\n        if (buttonName) {\n            if (fileName) {\n                buttonName.textContent = fileName;\n            } else {\n                buttonName.textContent = buttonName.dataset.initialText;\n            }\n        }\n    }\n});\n\n/**\n * Фикс для Firefox.\n */\ndocument.addEventListener('focus', function(event) {\n    const target = event.target;\n    if ((target.tagName === 'INPUT') && target.closest('.vClearableFileField')) {\n        target.classList.add('focused');\n    }\n});\n\ndocument.addEventListener('blur', function(event) {\n    const target = event.target;\n    if ((target.tagName === 'INPUT') && target.closest('.vClearableFileField')) {\n        target.classList.remove('focused');\n    }\n});\n","document.addEventListener('input', function(event) {\n    const target = event.target;\n    const input = target.closest('.vEmailInput');\n    const widget = input && input.closest('.input-group');\n    const link_tag = widget && widget.querySelector('.input-group-text');\n    if (link_tag) {\n        let email = input.value.trim();\n        if (email) {\n            link_tag.href = 'mailto:' + input.value;\n        } else {\n            link_tag.removeAttribute('href');\n        }\n    }\n});\n","import \"multiselect\";\nimport whenDomReady from \"when-dom-ready\";\nimport emitters from \"../components/emitters\";\n\n// CSS\nimport \"../../css/widgets/multiselect.scss\";\n\n\nfunction initWidget(element) {\n    if (!element.closest('.empty-form')) {\n        $(element).multiSelect();\n    }\n}\n\n\n/**\n * Инициализация MultiSelect виджетов\n * @param {Element} [root]\n */\nfunction initWidgets(root = document.body) {\n    let selector = '.vMultiSelect';\n    root.matches(selector) && initWidget(root);\n    root.querySelectorAll(selector).forEach(initWidget);\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n","document.addEventListener('input', function(event) {\n    const target = event.target;\n    const input = target.closest('.vURLInput');\n    const widget = input && input.closest('.input-group');\n    const link_tag = widget && widget.querySelector('.input-group-text');\n    if (link_tag) {\n        let link = input.value.trim();\n        if (link) {\n            link_tag.href = link;\n        } else {\n            link_tag.removeAttribute('href');\n        }\n    }\n});\n","/**\n * Сортировка DOM-элементов с помощью кнопок.\n * @module SortButtons\n */\n\n/**\n * @typedef {Object} module:SortButtons.SortButtonsOptions\n * @property {Number}    speed\n * @property {String}    [items]\n * @property {String}    [moveUpBtn]\n * @property {String}    [moveDownBtn]\n * @property {String}    [disabledClass]\n * @property {?String}   [ignore]\n * @property {?Function} [onChange]\n */\nimport {gsap, TimelineLite} from \"gsap\";\nimport {ScrollToPlugin} from \"gsap/ScrollToPlugin\";\ngsap.registerPlugin(ScrollToPlugin);\n\n\n/**\n * Конструктор объектов SortButtons.\n * @param {Element} root\n * @param {module:SortButtons.SortButtonsOptions} [options]\n * @constructor\n */\nfunction SortButtons(root, options) {\n    /** @type module:SortButtons.SortButtonsOptions */\n    this.opts = Object.assign({\n        speed: 1,\n        items: '.item',\n        moveUpBtn: '.move-up',\n        moveDownBtn: '.move-down',\n        disabledClass: 'disabled',\n        scrollWindow: true,\n        scrollMargin: {\n            top: 300,\n            bottom: 350\n        },\n        ignore: null,\n        onChange: null\n    }, options);\n\n    /** @type {Element} */\n    this.root = root;\n\n    root.addEventListener('click', this._onClick.bind(this));\n    root.addEventListener('update:sortbuttons', this.updateBounds.bind(this));\n    this.updateBounds();\n}\n\n/**\n * Обработчик события клика в пределах корневого элемента.\n * @param {MouseEvent} event\n * @private\n */\nSortButtons.prototype._onClick = function(event) {\n    const target = event.target;\n\n    const moveUpButton = target.closest(this.opts.moveUpBtn);\n    if (moveUpButton && this.root.contains(moveUpButton)) {\n        if (moveUpButton.classList.contains(this.opts.disabledClass)) {\n            return\n        }\n\n        const item = moveUpButton.closest(this.opts.items);\n        if (item) {\n            event.preventDefault();\n            event.stopPropagation();\n            this.moveUp(item);\n        }\n        return\n    }\n\n    const moveDownButton = target.closest(this.opts.moveDownBtn);\n    if (moveDownButton && this.root.contains(moveDownButton)) {\n        if (moveDownButton.classList.contains(this.opts.disabledClass)) {\n            return\n        }\n\n        const item = moveDownButton.closest(this.opts.items);\n        if (item) {\n            event.preventDefault();\n            event.stopPropagation();\n            this.moveDown(item);\n        }\n    }\n};\n\n/**\n * Поиск ближайшего перемещаемого элемента справа, начиная с element.\n * @param {Element} element\n * @returns {Element}\n * @private\n */\nSortButtons.prototype._findNextItem = function(element) {\n    let nextItem = element;\n    while (nextItem) {\n        if (this.opts.ignore && nextItem.matches(this.opts.ignore)) {\n            nextItem = nextItem.nextElementSibling;\n        } else if (!nextItem.matches(this.opts.items)) {\n            nextItem = nextItem.nextElementSibling;\n        } else {\n            break\n        }\n    }\n    return nextItem;\n};\n\n/**\n * Поиск ближайшего перемещаемого элемента слева, начиная с element.\n * @param {Element} element\n * @returns {Element}\n * @private\n */\nSortButtons.prototype._findPreviousItem = function(element) {\n    let prevItem = element;\n    while (prevItem) {\n        if (this.opts.ignore && prevItem.matches(this.opts.ignore)) {\n            prevItem = prevItem.previousElementSibling;\n        } else if (!prevItem.matches(this.opts.items)) {\n            prevItem = prevItem.previousElementSibling;\n        } else {\n            break\n        }\n    }\n    return prevItem;\n};\n\n/**\n * Перемещение элемента вниз.\n * @param {Element} item\n */\nSortButtons.prototype.moveDown = function(item) {\n    const nextItem = this._findNextItem(item.nextElementSibling);\n    if (nextItem) {\n        this._swap(item, nextItem);\n    }\n};\n\n/**\n * Перемещение элемента наверх.\n * @param {Element} item\n */\nSortButtons.prototype.moveUp = function(item) {\n    const prevItem = this._findPreviousItem(item.previousElementSibling);\n    if (prevItem) {\n        this._swap(prevItem, item, true);\n    }\n};\n\n/**\n * Меняет местами два соседних элемента elem1 и elem2 с анимацией.\n * @param {Element} elem1\n * @param {Element} elem2\n * @param {boolean} reversed - True, если elem2 считается активным\n * @private\n */\nSortButtons.prototype._swap = function(elem1, elem2, reversed=false) {\n    //   Initial state:\n    //\n    //  |-------------|\n    //  |    elem1    |\n    //  |             |\n    //  |-------------|\n    //\n    //  |-------------|\n    //  |    elem2    |\n    //  |-------------|\n    //\n\n    const rect1 = elem1.getBoundingClientRect();\n    const rect2 = elem2.getBoundingClientRect();\n    const initialCSSText1 = elem1.style.cssText;\n    const initialCSSText2 = elem2.style.cssText;\n\n    this.disableItemButtons(elem1);\n    this.disableItemButtons(elem2);\n    elem2.after(elem1);\n\n    // имитация начального расположения\n    const spaceY = rect2.top - rect1.top - rect1.height;\n    elem1.style.transform = `translate3d(0, ${-rect2.height - spaceY}px, ${reversed ? 0 : 1}px)`;\n    elem2.style.transform = `translate3d(0, ${rect2.top - rect1.top}px, ${reversed ? 1 : 0}px)`;\n\n    const tl = new TimelineLite({\n        onComplete: function() {\n            elem1.style.cssText = initialCSSText1;\n            elem2.style.cssText = initialCSSText2;\n            this.updateBounds();\n        }.bind(this)\n    })\n    .to(elem1, {duration: this.opts.speed, y: 0, clearProps: 'all'})\n    .to(elem2, {duration: this.opts.speed, y: 0, clearProps: 'all'}, 0);\n\n    if (this.opts.scrollWindow) {\n        const pageYOffset = window.pageYOffset || document.documentElement.scrollTop;\n        const newYOffset = pageYOffset + (reversed ? rect1.top - rect2.top : rect2.top - rect1.top);\n        const topBound = this.opts.scrollMargin.top;\n        const bottomBound = window.innerHeight - this.opts.scrollMargin.bottom;\n\n        let needScrollWindow = true;\n        if (reversed) {\n            needScrollWindow &= !((rect1.top > bottomBound) && (rect2.top > bottomBound));\n        } else {\n            needScrollWindow &= !((rect1.top < topBound) && (rect2.top < topBound));\n        }\n\n        if (needScrollWindow) {\n            tl.to(window, {\n                duration: this.opts.speed,\n                scrollTo: {\n                    y: Math.max(0, newYOffset)\n                }\n            }, 0)\n        }\n    }\n\n    // callback\n    if (typeof this.opts.onChange === 'function') {\n        this.opts.onChange.call(this, elem1, elem2);\n    }\n};\n\n/**\n * Отключение кнопок сортировки.\n * @param {Element} item\n */\nSortButtons.prototype.disableItemButtons = function(item) {\n    const upBtn = item.querySelector(this.opts.moveUpBtn);\n    const downBtn = item.querySelector(this.opts.moveDownBtn);\n    upBtn.classList.add(this.opts.disabledClass);\n    downBtn.classList.add(this.opts.disabledClass);\n};\n\n/**\n * Отключение у граничных элементов кнопок, которые не имеют смысла.\n */\nSortButtons.prototype.updateBounds = function() {\n    const items = this.root.querySelectorAll(this.opts.items);\n    if (!items.length) {\n        return\n    }\n\n    items.forEach(function(item) {\n        const upBtn = item.querySelector(this.opts.moveUpBtn);\n        const downBtn = item.querySelector(this.opts.moveDownBtn);\n        upBtn.classList.remove(this.opts.disabledClass);\n        downBtn.classList.remove(this.opts.disabledClass);\n    }.bind(this));\n\n    const firstItem = this._findNextItem(items[0]);\n    if (firstItem) {\n        const firstItemBtn = firstItem.querySelector(this.opts.moveUpBtn);\n        if (firstItemBtn) {\n            firstItemBtn.classList.add(this.opts.disabledClass);\n        }\n    }\n\n    const lastItem = this._findPreviousItem(items[items.length - 1]);\n    if (lastItem) {\n        const lastItemBtn = lastItem.querySelector(this.opts.moveDownBtn);\n        if (lastItemBtn) {\n            lastItemBtn.classList.add(this.opts.disabledClass);\n        }\n    }\n};\n\n\nexport default SortButtons;\n","import whenDomReady from \"when-dom-ready\";\nimport formUtils from \"../form_utils\";\nimport SortButtons from \"./SortButtons\";\n\n\nwhenDomReady(function() {\n    const inlineGroups = document.querySelectorAll('.sortable-inline-group');\n    inlineGroups.forEach(function(inlineGroup) {\n        const sortButtonsObj = new SortButtons(inlineGroup, {\n            speed: inlineGroup.dataset.inlineType === 'tabular' ? 0.25 : 0.5,\n            items: '.sortable-item',\n            moveUpBtn: '.sortable-move-up',\n            moveDownBtn: '.sortable-move-down',\n            ignore: '.empty-form'\n        });\n\n        inlineGroup.addEventListener('row-added', function() {\n            sortButtonsObj.updateBounds();\n        });\n    });\n});\n\n\n/**\n * Установка значения сортировки инлайн-формам.\n * @param {Element} inlineGroup\n */\nfunction fillInlineOrder(inlineGroup) {\n    let currentOrder = 0;\n    const inlineForms = inlineGroup.querySelectorAll('.sortable-item:not(.empty-form)');\n    inlineForms.forEach(function(inlineForm) {\n        if (inlineForm.classList.contains('has_original')\n            || formUtils.containsChangedField(inlineForm)) {\n            const input = inlineForm.querySelector('.sortable-input');\n            if (input) {\n                input.value = currentOrder++;\n            }\n        }\n    });\n}\n\n\n/**\n * Замена индекса формы на порядковый, чтобы бэкенд Django отображал\n * формы в правильном порядке при ошибках валидации.\n * @param {Element} row\n * @param {String} prefix\n * @param {Number} index\n */\nfunction replaceFormIndex(row, prefix, index) {\n    const regex = new RegExp(\"(\" + prefix + \"-(\\\\d+))\");\n    const replacement = prefix + \"-\" + index;\n    row.querySelectorAll('*').forEach(function(element) {\n        if (element.htmlFor) {\n            element.htmlFor = element.htmlFor.replace(regex, replacement);\n        }\n        if (element.id) {\n            element.id = element.id.replace(regex, replacement);\n        }\n        if (element.name) {\n            element.name = element.name.replace(regex, replacement);\n        }\n    });\n    row.setAttribute('id', prefix + '-' + index);\n}\n\n\ndocument.addEventListener('submit', function(event) {\n    const form = event.target;\n    const inlineGroups = form.querySelectorAll('.sortable-inline-group');\n    inlineGroups.forEach(function(inlineGroup) {\n        fillInlineOrder(inlineGroup);\n\n        const inlineFormset = inlineGroup._inline_formset;\n        const selector = '.' + inlineFormset.opts.formCssClass + ':not(.' + inlineFormset.opts.emptyCssClass + ')';\n        inlineGroup.querySelectorAll(selector).forEach(function(form, index) {\n            replaceFormIndex(form, inlineFormset.opts.prefix, index);\n        });\n    });\n});\n","import flatpickr from \"flatpickr\";\nimport whenDomReady from \"when-dom-ready\";\nimport emitters from \"../components/emitters\";\n\n// CSS\nimport \"flatpickr/dist/flatpickr.min.css\";\nimport \"../../css/widgets/datetime.scss\";\n\n\nfunction initWidget(options, element) {\n    if (!element.closest('.empty-form')) {\n        flatpickr(element, options);\n    }\n}\n\n\n/**\n * Инициализация DateTime виджетов\n * @param {Element} [root]\n */\nfunction initWidgets(root = document.body) {\n    let date_selector = '.vDatePicker';\n    let date_options = {\n        altInput: true,\n        altFormat: \"F j, Y\",\n        dateFormat: \"Y-m-d\"\n    };\n    root.matches(date_selector) && initWidget(date_options, root);\n    root.querySelectorAll(date_selector).forEach(initWidget.bind(null, date_options));\n\n    let time_selector = '.vTimePicker';\n    let time_options = {\n        allowInput: true,\n        enableTime: true,\n        noCalendar: true,\n        dateFormat: \"H:i\",\n        time_24hr: true\n    };\n    root.matches(time_selector) && initWidget(time_options, root);\n    root.querySelectorAll(time_selector).forEach(initWidget.bind(null, time_options));\n}\n\n\nwhenDomReady(initWidgets);\nemitters.dom.on('mutate', initWidgets);\n\n\n/**\n * Симуляция нажатия стрелок при прокрутке колеса мыши на полях выбора времени.\n */\ndocument.addEventListener('wheel', function(event) {\n    const target = event.target;\n    const widget = target.closest('.numInputWrapper');\n    const input = widget && widget.querySelector('input');\n    if (input) {\n        event.preventDefault();\n        const fake_event = new KeyboardEvent('keydown', {\n            bubbles: true,\n            cancelable: true,\n            keyCode: event.deltaY > 0 ? 40 : 38\n        });\n        input.dispatchEvent(fake_event);\n    }\n}, {passive: false});\n\n\n/**\n * Клик на иконку календаря\n */\ndocument.addEventListener('click', function(event) {\n    const target = event.target;\n    const button = target.closest('.vDateFieldTrigger');\n    const widget = button && button.closest('.input-group');\n    const input = widget && widget.querySelector('.vDateInput');\n    if (input && input._flatpickr) {\n        setTimeout(function() {\n            input._flatpickr.open();\n        }, 0)\n    }\n});\n","/* global gettext */\n\nimport whenDomReady from \"when-dom-ready\";\nimport hookUnload from \"./components/hook_unload\";\nimport \"./components/inlines/inlines\";\nimport \"./components/inlines/sortable\";\nimport \"./components/RelatedObjectLookups\";\nimport \"./components/autosize\";\nimport \"./components/tabs\";\nimport \"./widgets/autocomplete\";\nimport \"./widgets/clearable_file\";\nimport \"./widgets/datetime\";\nimport \"./widgets/email\";\nimport \"./widgets/multiselect\";\nimport \"./widgets/password\";\nimport \"./widgets/url\";\n\n\nwhenDomReady(function() {\n    // предупреждение при закрытии формы\n    const form = document.getElementById('changeform');\n    if (form) {\n        hookUnload(form);\n    }\n\n    // динамическая подгрузка скрипта для prepopulate_fields\n    if (window.django_prepopulated_fields && window.django_prepopulated_fields.length) {\n        import(/* webpackChunkName: \"prepopulate\" */ './components/prepopulate/prepopulate');\n    }\n});\n","// Handles related-objects functionality: lookup link for raw_id_fields\n// and Add Another links.\n\n(function($) {\n    'use strict';\n\n    // IE doesn't accept periods or dashes in the window name, but the element IDs\n    // we use to generate popup window names may contain them, therefore we map them\n    // to allowed characters in a reversible way so that we can locate the correct\n    // element when the popup window is dismissed.\n    function id_to_windowname(text) {\n        text = text.replace(/\\./g, '__dot__');\n        text = text.replace(/-/g, '__dash__');\n        return text;\n    }\n\n    function windowname_to_id(text) {\n        text = text.replace(/__dot__/g, '.');\n        text = text.replace(/__dash__/g, '-');\n        return text;\n    }\n\n    function showAdminPopup(triggeringLink, name_regexp, add_popup) {\n        let name = triggeringLink.id.replace(name_regexp, '');\n        name = id_to_windowname(name);\n        let href = triggeringLink.href;\n        if (add_popup) {\n            if (href.indexOf('?') === -1) {\n                href += '?_popup=1';\n            } else {\n                href += '&_popup=1';\n            }\n        }\n\n        // Центрирование popup\n        const browser_left = typeof window.screenX !== 'undefined' ? window.screenX : window.screenLeft,\n            browser_top = typeof window.screenY !== 'undefined' ? window.screenY : window.screenTop,\n            browser_width = typeof window.outerWidth !== 'undefined' ? window.outerWidth : document.body.clientWidth,\n            browser_height = typeof window.outerHeight !== 'undefined' ? window.outerHeight : document.body.clientHeight,\n            popup_width = 940,\n            popup_height = 600,\n            top_position = browser_top + Math.round((browser_height - popup_height) / 2),\n            left_position = browser_left + Math.round((browser_width - popup_width) / 2);\n\n        const win = window.open(href, name,\n            'width=' + popup_width +\n            ',height=' + popup_height +\n            ',top=' + top_position +\n            ',left=' + left_position +\n            ',resizable=yes,scrollbars=yes'\n        );\n\n        win.focus();\n        return false;\n    }\n\n    function showRelatedObjectLookupPopup(triggeringLink) {\n        return showAdminPopup(triggeringLink, /^lookup_/, true);\n    }\n\n    function dismissRelatedLookupPopup(win, chosenId) {\n        const name = windowname_to_id(win.name);\n        const elem = document.getElementById(name);\n        if (elem.className.indexOf('vManyToManyRawIdAdminField') !== -1 && elem.value) {\n            elem.value += ',' + chosenId;\n        } else {\n            document.getElementById(name).value = chosenId;\n        }\n        win.close();\n    }\n\n    function showRelatedObjectPopup(triggeringLink) {\n        return showAdminPopup(triggeringLink, /^(change|add|delete)_/, false);\n    }\n\n    function updateRelatedObjectLinks(triggeringLink) {\n        const $this = $(triggeringLink);\n        const siblings = $this.closest('.related-widget-wrapper').find('.view-related, .change-related, .delete-related');\n        if (!siblings.length) {\n            return;\n        }\n        const value = $this.val();\n        if (value) {\n            siblings.each(function() {\n                const elm = $(this);\n                elm.attr('href', elm.attr('data-href-template').replace('__fk__', value));\n            });\n        } else {\n            siblings.removeAttr('href');\n        }\n    }\n\n    function dismissAddRelatedObjectPopup(win, newId, newRepr) {\n        const name = windowname_to_id(win.name);\n        const elem = document.getElementById(name);\n        if (elem) {\n            const elemName = elem.nodeName.toUpperCase();\n            if (elemName === 'SELECT') {\n                elem.options[elem.options.length] = new Option(newRepr, newId, true, true);\n            } else if (elemName === 'INPUT') {\n                if (elem.className.indexOf('vManyToManyRawIdAdminField') !== -1 && elem.value) {\n                    elem.value += ',' + newId;\n                } else {\n                    elem.value = newId;\n                }\n            }\n            // Trigger a change event to update related links if required.\n            $(elem).trigger('change');\n        }\n        win.close();\n    }\n\n    function dismissChangeRelatedObjectPopup(win, objId, newRepr, newId) {\n        const id = windowname_to_id(win.name).replace(/^edit_/, '');\n        const select = $('#' + id);\n        select.find('option').each(function() {\n            if (this.value === objId) {\n                this.textContent = newRepr;\n                this.value = newId;\n            }\n        });\n        win.close();\n    }\n\n    function dismissDeleteRelatedObjectPopup(win, objId) {\n        const id = windowname_to_id(win.name).replace(/^delete_/, '');\n        const select = $('#' + id);\n        select.find('option').each(function() {\n            if (this.value === objId) {\n                $(this).remove();\n            }\n        }).trigger('change');\n        win.close();\n    }\n\n    // Global for testing purposes\n    window.id_to_windowname = id_to_windowname;\n    window.windowname_to_id = windowname_to_id;\n\n    window.showRelatedObjectLookupPopup = showRelatedObjectLookupPopup;\n    window.dismissRelatedLookupPopup = dismissRelatedLookupPopup;\n    window.showRelatedObjectPopup = showRelatedObjectPopup;\n    window.updateRelatedObjectLinks = updateRelatedObjectLinks;\n    window.dismissAddRelatedObjectPopup = dismissAddRelatedObjectPopup;\n    window.dismissChangeRelatedObjectPopup = dismissChangeRelatedObjectPopup;\n    window.dismissDeleteRelatedObjectPopup = dismissDeleteRelatedObjectPopup;\n\n    // Kept for backward compatibility\n    window.showAddAnotherPopup = showRelatedObjectPopup;\n    window.dismissAddAnotherPopup = dismissAddRelatedObjectPopup;\n\n    $(document).ready(function() {\n        $(\"a[data-popup-opener]\").on('click', function(event) {\n            event.preventDefault();\n            opener.dismissRelatedLookupPopup(window, $(this).data(\"popup-opener\"));\n        });\n        $('body').on('click', '.related-widget-wrapper-link', function(e) {\n            e.preventDefault();\n            if (this.href) {\n                const event = $.Event('django:show-related', {href: this.href});\n                $(this).trigger(event);\n                if (!event.isDefaultPrevented()) {\n                    showRelatedObjectPopup(this);\n                }\n            }\n        }).on('change', '.related-widget-wrapper select', function() {\n            const event = $.Event('django:update-related');\n            $(this).trigger(event);\n            if (!event.isDefaultPrevented()) {\n                updateRelatedObjectLinks(this);\n            }\n        }).on('change', '.related-widget-wrapper input', function() {\n            if (this.checked) {\n                updateRelatedObjectLinks(this);\n            }\n        }).on('click', '.related-lookup', function(e) {\n            e.preventDefault();\n            const event = $.Event('django:lookup-related');\n            $(this).trigger(event);\n            if (!event.isDefaultPrevented()) {\n                showRelatedObjectLookupPopup(this);\n            }\n        });\n\n        $('.related-widget-wrapper select').trigger('change');\n        $('.related-widget-wrapper input:checked').trigger('change');\n    });\n\n})(jQuery);\n","/* global gettext */\n\n/**\n * Инициализация отслеживания изменения формы и вывод\n * предупреждения при попытке закрыть страницу без сохранения.\n */\nexport default function hookUnload(form) {\n    let submit = false;\n    let formHasChanged = false;\n\n    form.addEventListener('submit', function() {\n        submit = true;\n    });\n\n    const message = gettext('You have unsaved changes');\n    window.addEventListener('beforeunload', function(evt) {\n        if (!submit && formHasChanged) {\n            evt.returnValue = message;\n            return message;\n        }\n    });\n\n    // начинаем отслеживать изменения после первого действия\n    // пользователя, чтобы игнорировать последствия инициализации\n    document.addEventListener('keydown', userActionHandler);\n    document.addEventListener('mousedown', userActionHandler);\n    function userActionHandler() {\n        document.removeEventListener('keydown', userActionHandler);\n        document.removeEventListener('mousedown', userActionHandler);\n        form.addEventListener('change', function changeHandler(event) {\n            form.removeEventListener('change', changeHandler);\n\n            const target = event.target;\n            const widget = target.closest('.form-widget');\n            if (widget && form.contains(widget)) {\n                formHasChanged = true;\n            }\n        });\n    }\n}\n","document.addEventListener('click', function(event) {\n    const target = event.target;\n    const toggler = target.closest('.vPasswordTrigger');\n    if (toggler) {\n        const field = toggler.closest('.input-group');\n        const icon = field && field.querySelector('i.fa');\n        const input = field && field.querySelector('input');\n        if (input) {\n            const classes = ['fa-eye-slash', 'fa-eye'];\n            const types = ['text', 'password'];\n            const index = (types.indexOf(input.type) + 1) % 2;\n            input.type = types[index];\n            icon.classList.add(classes[index]);\n            icon.classList.remove(classes[(index + 1) % 2]);\n        }\n    }\n});\n"],"sourceRoot":""}